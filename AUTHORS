Author of original code:

    Ervin Hegedus <airween@digitalwave.hu>

The foreign parts of code and its source are marked with comment.